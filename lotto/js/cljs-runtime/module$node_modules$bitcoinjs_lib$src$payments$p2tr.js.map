{
"version":3,
"file":"module$node_modules$bitcoinjs_lib$src$payments$p2tr.js",
"lineCount":16,
"mappings":"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",
"sources":["node_modules/bitcoinjs-lib/src/payments/p2tr.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$bitcoinjs_lib$src$payments$p2tr\"] = function(global,require,module,exports) {\n'use strict';\nObject.defineProperty(exports, '__esModule', { value: true });\nexports.p2tr = void 0;\nconst buffer_1 = require('buffer');\nconst networks_1 = require('../networks');\nconst bscript = require('../script');\nconst types_1 = require('../types');\nconst ecc_lib_1 = require('../ecc_lib');\nconst bip341_1 = require('./bip341');\nconst lazy = require('./lazy');\nconst bech32_1 = require('bech32');\nconst OPS = bscript.OPS;\nconst TAPROOT_WITNESS_VERSION = 0x01;\nconst ANNEX_PREFIX = 0x50;\nfunction p2tr(a, opts) {\n  if (\n    !a.address &&\n    !a.output &&\n    !a.pubkey &&\n    !a.internalPubkey &&\n    !(a.witness && a.witness.length > 1)\n  )\n    throw new TypeError('Not enough data');\n  opts = Object.assign({ validate: true }, opts || {});\n  (0, types_1.typeforce)(\n    {\n      address: types_1.typeforce.maybe(types_1.typeforce.String),\n      input: types_1.typeforce.maybe(types_1.typeforce.BufferN(0)),\n      network: types_1.typeforce.maybe(types_1.typeforce.Object),\n      output: types_1.typeforce.maybe(types_1.typeforce.BufferN(34)),\n      internalPubkey: types_1.typeforce.maybe(types_1.typeforce.BufferN(32)),\n      hash: types_1.typeforce.maybe(types_1.typeforce.BufferN(32)),\n      pubkey: types_1.typeforce.maybe(types_1.typeforce.BufferN(32)),\n      signature: types_1.typeforce.maybe(types_1.typeforce.BufferN(64)),\n      witness: types_1.typeforce.maybe(\n        types_1.typeforce.arrayOf(types_1.typeforce.Buffer),\n      ),\n      scriptTree: types_1.typeforce.maybe(types_1.isTaptree),\n      redeem: types_1.typeforce.maybe({\n        output: types_1.typeforce.maybe(types_1.typeforce.Buffer),\n        redeemVersion: types_1.typeforce.maybe(types_1.typeforce.Number),\n        witness: types_1.typeforce.maybe(\n          types_1.typeforce.arrayOf(types_1.typeforce.Buffer),\n        ),\n      }),\n      redeemVersion: types_1.typeforce.maybe(types_1.typeforce.Number),\n    },\n    a,\n  );\n  const _address = lazy.value(() => {\n    const result = bech32_1.bech32m.decode(a.address);\n    const version = result.words.shift();\n    const data = bech32_1.bech32m.fromWords(result.words);\n    return {\n      version,\n      prefix: result.prefix,\n      data: buffer_1.Buffer.from(data),\n    };\n  });\n  // remove annex if present, ignored by taproot\n  const _witness = lazy.value(() => {\n    if (!a.witness || !a.witness.length) return;\n    if (\n      a.witness.length >= 2 &&\n      a.witness[a.witness.length - 1][0] === ANNEX_PREFIX\n    ) {\n      return a.witness.slice(0, -1);\n    }\n    return a.witness.slice();\n  });\n  const _hashTree = lazy.value(() => {\n    if (a.scriptTree) return (0, bip341_1.toHashTree)(a.scriptTree);\n    if (a.hash) return { hash: a.hash };\n    return;\n  });\n  const network = a.network || networks_1.bitcoin;\n  const o = { name: 'p2tr', network };\n  lazy.prop(o, 'address', () => {\n    if (!o.pubkey) return;\n    const words = bech32_1.bech32m.toWords(o.pubkey);\n    words.unshift(TAPROOT_WITNESS_VERSION);\n    return bech32_1.bech32m.encode(network.bech32, words);\n  });\n  lazy.prop(o, 'hash', () => {\n    const hashTree = _hashTree();\n    if (hashTree) return hashTree.hash;\n    const w = _witness();\n    if (w && w.length > 1) {\n      const controlBlock = w[w.length - 1];\n      const leafVersion = controlBlock[0] & types_1.TAPLEAF_VERSION_MASK;\n      const script = w[w.length - 2];\n      const leafHash = (0, bip341_1.tapleafHash)({\n        output: script,\n        version: leafVersion,\n      });\n      return (0, bip341_1.rootHashFromPath)(controlBlock, leafHash);\n    }\n    return null;\n  });\n  lazy.prop(o, 'output', () => {\n    if (!o.pubkey) return;\n    return bscript.compile([OPS.OP_1, o.pubkey]);\n  });\n  lazy.prop(o, 'redeemVersion', () => {\n    if (a.redeemVersion) return a.redeemVersion;\n    if (\n      a.redeem &&\n      a.redeem.redeemVersion !== undefined &&\n      a.redeem.redeemVersion !== null\n    ) {\n      return a.redeem.redeemVersion;\n    }\n    return bip341_1.LEAF_VERSION_TAPSCRIPT;\n  });\n  lazy.prop(o, 'redeem', () => {\n    const witness = _witness(); // witness without annex\n    if (!witness || witness.length < 2) return;\n    return {\n      output: witness[witness.length - 2],\n      witness: witness.slice(0, -2),\n      redeemVersion:\n        witness[witness.length - 1][0] & types_1.TAPLEAF_VERSION_MASK,\n    };\n  });\n  lazy.prop(o, 'pubkey', () => {\n    if (a.pubkey) return a.pubkey;\n    if (a.output) return a.output.slice(2);\n    if (a.address) return _address().data;\n    if (o.internalPubkey) {\n      const tweakedKey = (0, bip341_1.tweakKey)(o.internalPubkey, o.hash);\n      if (tweakedKey) return tweakedKey.x;\n    }\n  });\n  lazy.prop(o, 'internalPubkey', () => {\n    if (a.internalPubkey) return a.internalPubkey;\n    const witness = _witness();\n    if (witness && witness.length > 1)\n      return witness[witness.length - 1].slice(1, 33);\n  });\n  lazy.prop(o, 'signature', () => {\n    if (a.signature) return a.signature;\n    const witness = _witness(); // witness without annex\n    if (!witness || witness.length !== 1) return;\n    return witness[0];\n  });\n  lazy.prop(o, 'witness', () => {\n    if (a.witness) return a.witness;\n    const hashTree = _hashTree();\n    if (hashTree && a.redeem && a.redeem.output && a.internalPubkey) {\n      const leafHash = (0, bip341_1.tapleafHash)({\n        output: a.redeem.output,\n        version: o.redeemVersion,\n      });\n      const path = (0, bip341_1.findScriptPath)(hashTree, leafHash);\n      if (!path) return;\n      const outputKey = (0, bip341_1.tweakKey)(a.internalPubkey, hashTree.hash);\n      if (!outputKey) return;\n      const controlBock = buffer_1.Buffer.concat(\n        [\n          buffer_1.Buffer.from([o.redeemVersion | outputKey.parity]),\n          a.internalPubkey,\n        ].concat(path),\n      );\n      return [a.redeem.output, controlBock];\n    }\n    if (a.signature) return [a.signature];\n  });\n  // extended validation\n  if (opts.validate) {\n    let pubkey = buffer_1.Buffer.from([]);\n    if (a.address) {\n      if (network && network.bech32 !== _address().prefix)\n        throw new TypeError('Invalid prefix or Network mismatch');\n      if (_address().version !== TAPROOT_WITNESS_VERSION)\n        throw new TypeError('Invalid address version');\n      if (_address().data.length !== 32)\n        throw new TypeError('Invalid address data');\n      pubkey = _address().data;\n    }\n    if (a.pubkey) {\n      if (pubkey.length > 0 && !pubkey.equals(a.pubkey))\n        throw new TypeError('Pubkey mismatch');\n      else pubkey = a.pubkey;\n    }\n    if (a.output) {\n      if (\n        a.output.length !== 34 ||\n        a.output[0] !== OPS.OP_1 ||\n        a.output[1] !== 0x20\n      )\n        throw new TypeError('Output is invalid');\n      if (pubkey.length > 0 && !pubkey.equals(a.output.slice(2)))\n        throw new TypeError('Pubkey mismatch');\n      else pubkey = a.output.slice(2);\n    }\n    if (a.internalPubkey) {\n      const tweakedKey = (0, bip341_1.tweakKey)(a.internalPubkey, o.hash);\n      if (pubkey.length > 0 && !pubkey.equals(tweakedKey.x))\n        throw new TypeError('Pubkey mismatch');\n      else pubkey = tweakedKey.x;\n    }\n    if (pubkey && pubkey.length) {\n      if (!(0, ecc_lib_1.getEccLib)().isXOnlyPoint(pubkey))\n        throw new TypeError('Invalid pubkey for p2tr');\n    }\n    const hashTree = _hashTree();\n    if (a.hash && hashTree) {\n      if (!a.hash.equals(hashTree.hash)) throw new TypeError('Hash mismatch');\n    }\n    if (a.redeem && a.redeem.output && hashTree) {\n      const leafHash = (0, bip341_1.tapleafHash)({\n        output: a.redeem.output,\n        version: o.redeemVersion,\n      });\n      if (!(0, bip341_1.findScriptPath)(hashTree, leafHash))\n        throw new TypeError('Redeem script not in tree');\n    }\n    const witness = _witness();\n    // compare the provided redeem data with the one computed from witness\n    if (a.redeem && o.redeem) {\n      if (a.redeem.redeemVersion) {\n        if (a.redeem.redeemVersion !== o.redeem.redeemVersion)\n          throw new TypeError('Redeem.redeemVersion and witness mismatch');\n      }\n      if (a.redeem.output) {\n        if (bscript.decompile(a.redeem.output).length === 0)\n          throw new TypeError('Redeem.output is invalid');\n        // output redeem is constructed from the witness\n        if (o.redeem.output && !a.redeem.output.equals(o.redeem.output))\n          throw new TypeError('Redeem.output and witness mismatch');\n      }\n      if (a.redeem.witness) {\n        if (\n          o.redeem.witness &&\n          !stacksEqual(a.redeem.witness, o.redeem.witness)\n        )\n          throw new TypeError('Redeem.witness and witness mismatch');\n      }\n    }\n    if (witness && witness.length) {\n      if (witness.length === 1) {\n        // key spending\n        if (a.signature && !a.signature.equals(witness[0]))\n          throw new TypeError('Signature mismatch');\n      } else {\n        // script path spending\n        const controlBlock = witness[witness.length - 1];\n        if (controlBlock.length < 33)\n          throw new TypeError(\n            `The control-block length is too small. Got ${controlBlock.length}, expected min 33.`,\n          );\n        if ((controlBlock.length - 33) % 32 !== 0)\n          throw new TypeError(\n            `The control-block length of ${controlBlock.length} is incorrect!`,\n          );\n        const m = (controlBlock.length - 33) / 32;\n        if (m > 128)\n          throw new TypeError(\n            `The script path is too long. Got ${m}, expected max 128.`,\n          );\n        const internalPubkey = controlBlock.slice(1, 33);\n        if (a.internalPubkey && !a.internalPubkey.equals(internalPubkey))\n          throw new TypeError('Internal pubkey mismatch');\n        if (!(0, ecc_lib_1.getEccLib)().isXOnlyPoint(internalPubkey))\n          throw new TypeError('Invalid internalPubkey for p2tr witness');\n        const leafVersion = controlBlock[0] & types_1.TAPLEAF_VERSION_MASK;\n        const script = witness[witness.length - 2];\n        const leafHash = (0, bip341_1.tapleafHash)({\n          output: script,\n          version: leafVersion,\n        });\n        const hash = (0, bip341_1.rootHashFromPath)(controlBlock, leafHash);\n        const outputKey = (0, bip341_1.tweakKey)(internalPubkey, hash);\n        if (!outputKey)\n          // todo: needs test data\n          throw new TypeError('Invalid outputKey for p2tr witness');\n        if (pubkey.length && !pubkey.equals(outputKey.x))\n          throw new TypeError('Pubkey mismatch for p2tr witness');\n        if (outputKey.parity !== (controlBlock[0] & 1))\n          throw new Error('Incorrect parity');\n      }\n    }\n  }\n  return Object.assign(o, a);\n}\nexports.p2tr = p2tr;\nfunction stacksEqual(a, b) {\n  if (a.length !== b.length) return false;\n  return a.every((x, i) => {\n    return x.equals(b[i]);\n  });\n}\n\n};"],
"names":["shadow$provide","global","require","module","exports","stacksEqual","a","b","length","every","x","i","equals","Object","defineProperty","value","p2tr","buffer_1","networks_1","bscript","types_1","ecc_lib_1","bip341_1","lazy","bech32_1","OPS","opts","address","output","pubkey","internalPubkey","witness","TypeError","assign","validate","typeforce","maybe","String","input","BufferN","network","hash","signature","arrayOf","Buffer","scriptTree","isTaptree","redeem","redeemVersion","Number","_address","result","bech32m","decode","version","words","shift","data","fromWords","prefix","from","_witness","ANNEX_PREFIX","slice","_hashTree","toHashTree","bitcoin","o","name","prop","toWords","unshift","TAPROOT_WITNESS_VERSION","encode","bech32","hashTree","w","controlBlock","leafHash","tapleafHash","script","TAPLEAF_VERSION_MASK","rootHashFromPath","compile","OP_1","undefined","LEAF_VERSION_TAPSCRIPT","tweakedKey","tweakKey","path","findScriptPath","outputKey","controlBock","concat","parity","getEccLib","isXOnlyPoint","decompile","m","Error"]
}
